import pandas as pd
import numpy as np
from matplotlib import pyplot as plt
import seaborn as sns

# Read the dataset
df = pd.read_csv('AppleStore.csv')

# Define the categories of interest
categories = ['Education', 'Entertainment', 'Games', 'Others', 'Photo & Video']

# Initialize a dictionary to hold the counts for free and paid apps
category_counts = {category: {'free': 0, 'paid': 0} for category in categories}

# Other category will include all apps not in the predefined categories
other_category = 'Others'

# Process the data
for index, row in df.iterrows():
    category = row['prime_genre']
    if category not in categories:
        category = other_category
    
    if row['price'] == 0.0:
        category_counts[category]['free'] += 1
    else:
        category_counts[category]['paid'] += 1

# Calculate proportions
total_counts = {category: sum(counts.values()) for category, counts in category_counts.items()}
tuple_free = [category_counts[category]['free'] / total_counts[category] for category in categories]
tuple_paidapps = [category_counts[category]['paid'] / total_counts[category] for category in categories]

plt.figure(figsize=(15,8))
N = len(categories)
ind = np.arange(N)    # the x locations for the groups
width = 0.56   # the width of the bars

p1 = plt.bar(ind, tuple_free, width, color='#45cea2')
p2 = plt.bar(ind, tuple_paidapps, width, bottom=tuple_free, color='#fdd470')

plt.xticks(ind, categories)
plt.legend((p1[0], p2[0]), ('Free', 'Paid'))
plt.savefig('./result.png')